<div class="card">
    <h2>ðŸ“‹ Pedidos</h2>
    
    <div style="margin-bottom: 20px;">
        <a href="/pedidos/novo" class="btn">âž• Novo Pedido</a>
    </div>

    <% if @pedidos.any? %>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Cliente</th>
                    <th>ServiÃ§o</th>
                    <th>Valor</th>
                    <th>Status</th>
                    <th>Entrega</th>
                    <th>AÃ§Ãµes</th>
                </tr>
            </thead>
            <tbody>
                <% @pedidos.each do |pedido| %>
                    <tr>
                        <td>#<%= pedido['id'] %></td>
                        <td><%= pedido['cliente_nome'] %></td>
                        <td><%= pedido['tipo_servico'] %></td>
                        <td>R$ <%= '%.2f' % pedido['preco'] %></td>
                        <td>
                            <form action="/pedidos/<%= pedido['id'] %>/status" method="post" style="display: inline;">
                                <select name="novo_status" onchange="this.form.submit()">
                                    <option value="pendente" <%= 'selected' if pedido['status'] == 'pendente' %>>Pendente</option>
                                    <option value="andamento" <%= 'selected' if pedido['status'] == 'andamento' %>>Andamento</option>
                                    <option value="concluido" <%= 'selected' if pedido['status'] == 'concluido' %>>ConcluÃ­do</option>
                                    <option value="entregue" <%= 'selected' if pedido['status'] == 'entregue' %>>Entregue</option>
                                </select>
                            </form>
                        </td>
                        <td><%= Date.parse(pedido['data_entrega']).strftime('%d/%m/%Y') rescue pedido['data_entrega'] %></td>
                        <td>
                            <% if pedido['status'] == 'entregue' %>
                                <%= pedido['pago'] ? 'ðŸ’° Pago' : 'ðŸ’³ Pendente' %>
                            <% end %>
                        </td>
                    </tr>
                <% end %>
            </tbody>
        </table>
    <% else %>
        <p>Nenhum pedido cadastrado ainda.</p>
    <% end %>
</div>